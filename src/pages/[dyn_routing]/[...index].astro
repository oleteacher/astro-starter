---
//Imports
import { useTranslations, useTranslatedPath } from "@i18n/utils";
import Base from "@layouts/Base.astro";

// Get current language from URL
export function getStaticPaths() {
    return [
        // English route: /dynamic-routing
        // Since this file is in [dyn_routing] folder, the [dyn_routing] param becomes "dynamic-routing"
        // [...index] = undefined means no additional URL segments after /dynamic-routing
        {
            params: { dyn_routing: "dynamic-routing", index: undefined },
            props: { lang: "en" },
        },
        // Slovenian route: /sl/dinamicno-usmerjanje
        // [dyn_routing] = "sl" acts as language prefix in URL
        // [...index] = "dinamicno-usmerjanje" captures the localized page name after /sl/
        // This creates the final URL: /sl/dinamicno-usmerjanje
        {
            params: { dyn_routing: `sl`, index: "dinamicno-usmerjanje" },
            props: { lang: "sl" },
        },
    ];
}

// Props
const { lang } = Astro.props;

// Translations
const t = useTranslations(lang);
const translatePath = useTranslatedPath(lang);
---

<Base
    title={t("routing:head.title")}
    meta={{
        description: t("routing:head.description"),
        keywords: t("routing:head.keywords"),
    }}
>
    <section>
        <h1 id="main-heading">{t("routing:title")}</h1>
        <p class="text-center" set:html={t("routing:description")} />

        <div
            class="flex flex-col md:flex-row gap-8 mt-16"
            role="list"
            aria-label="Available routing examples"
        >
            {
                Object.keys(t("routing:subpages")).map((key) => {
                    const title = t(`routing:subpages.${key}.title`);
                    const desc = t(`routing:subpages.${key}.description`).split(
                        "<br />"
                    )[0];

                    return (
                        <article class="card" role="listitem">
                            <a
                                href={translatePath(`/dynamic-routing/${key}`)}
                                title={desc}
                                aria-label={`Read more about ${title}`}
                            >
                                <h2>{title}</h2>
                                <p>{desc}</p>
                                <div class="mt-4 w-fit">
                                    <p aria-hidden="true" class="button">
                                        {t("routing:link")} â†’
                                    </p>
                                </div>
                            </a>
                        </article>
                    );
                })
            }
        </div>
    </section>
</Base>
